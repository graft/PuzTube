%script{ :type => "text/javascript" }
  user = '#{ current_user.login }';
  channel = '#{ @topic.chat_id }';
  thread = '#{ @topic.class }';
= javascript_include_tag :defaults
= javascript_include_tag :chat
= javascript_include_tag :workspaces
= javascript_include_tag "http://#{hostname}:5000/socket.io/socket.io.js"
= javascript_include_tag "socket-users"

- content_for :title, "#{@topic.name}"

#mainpage

  = render :partial => "welcome/login"
  %h1= @topic.name

  = link_to 'Back', topics_path
  %br

.hidden#editables
  = link_to 'New Comment', new_workspace_path(:type => 'topic', :name => @topic.name), :remote => true, :method => :post
#comments
- @topic.workspaces.each do |ws|
  = render :partial => 'workspace/block', :locals => { :workspace => ws }
= render :partial => 'chats/window', :locals => { :chats => @chats, :thread => @topic, :multi => nil }

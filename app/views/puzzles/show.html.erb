<% content_for :title, "#{@puzzle.name}" %>

<script type="text/javascript">
  user = '<%= current_user.login %>';
  channel = '<%= @puzzle.chat_id %>';
</script>

<%= javascript_include_tag :defaults %>
<%= javascript_include_tag "chat" %>
<%= javascript_include_tag "workspaces" %>
<%= javascript_include_tag "http://mayhem.mit.edu:5000/socket.io/socket.io.js" %>
<%= javascript_include_tag "socket-users" %>
<%= javascript_include_tag "jquery.tablesorter" %>
<!-- <%= javascript_include_tag "resize" %> -->
<!-- <%= javascript_include_tag "tablekit" %> -->


<div id="mainpage">
<%= render :partial => "welcome/login" %> 

<div id="info">
  <%= render :partial => 'info', :locals => { :puzzle => @puzzle } %>
</div>

<div id="editables" class="hidden">
  <%= link_to 'New Comment', new_workspace_path(:type => 'puzzle', :id => @puzzle.id), :method => :post, :remote => true %>
  <div id="comments">
<% @puzzle.comments.each do |comment| %>
<%   if comment.class == Workspace %>
  <%= render :partial => 'workspace/block', :locals => { :workspace => comment } %>
<%   end %>
<% end %>
  </div>
</div>
</div>
<%= render :partial => 'chats/window', :locals => { :chats => @chats, :thread => @puzzle, :multi => nil } %>
